<VirtualHost *:80>
    ServerAdmin troncy@eurecom.fr
    ServerName kflow.eurecom.fr

    DocumentRoot "/var/www/kflow/"
    <Directory "/var/www/kflow/">
        Options Indexes FollowSymLinks
        AllowOverride All
        Order allow,deny
        Allow from all
        Header set Access-Control-Allow-Origin "*"
    </Directory>

        RewriteRule ^/vocabulary(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/vocabulary$1
      ProxyPass /vocabulary http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fvocabulary
    ProxyPassReverse /vocabulary http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fvocabulary


    RewriteRule ^/condition(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/condition$1
      ProxyPass /condition http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fcondition
    ProxyPassReverse /condition http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fcondition


    RewriteRule ^/paper(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/paper$1
      ProxyPass /paper http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fpaper
    ProxyPassReverse /paper http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fpaper


    RewriteRule ^/provenance(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/provenance$1
      ProxyPass /provenance http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fprovenance
    ProxyPassReverse /provenance http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fprovenance


    RewriteRule ^/event(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/event$1
      ProxyPass /event http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fevent
    ProxyPassReverse /event http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fevent


    
      ProxyPass /sparql http://localhost:7201/sparql
    ProxyPassReverse /sparql http://localhost:7201/sparql


    
      ProxyPass /login http://localhost:7201/login
    ProxyPassReverse /login http://localhost:7201/login


    
      ProxyPass /import http://localhost:7201/import
    ProxyPassReverse /import http://localhost:7201/import


    
      ProxyPass /resource http://localhost:7201/resource
    ProxyPassReverse /resource http://localhost:7201/resource


    ProxyPass        /         http://localhost:7201/
    ProxyPassReverse /         http://localhost:7201/

        RewriteRule ^/vocabulary(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/vocabulary$1
      ProxyPass /vocabulary http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fvocabulary
    ProxyPassReverse /vocabulary http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fvocabulary


    RewriteRule ^/condition(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/condition$1
      ProxyPass /condition http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fcondition
    ProxyPassReverse /condition http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fcondition


    RewriteRule ^/paper(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/paper$1
      ProxyPass /paper http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fpaper
    ProxyPassReverse /paper http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fpaper


    RewriteRule ^/provenance(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/provenance$1
      ProxyPass /provenance http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fprovenance
    ProxyPassReverse /provenance http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fprovenance


    RewriteRule ^/event(.*)$ http://%{SERVER_NAME}/resource?uri=http://%{SERVER_NAME}/event$1
      ProxyPass /event http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fevent
    ProxyPassReverse /event http://localhost:7201/resource?uri=http%3A%2F%2Fkflow.eurecom.fr%2Fevent


    
      ProxyPass /sparql http://localhost:7201/sparql
    ProxyPassReverse /sparql http://localhost:7201/sparql


    
      ProxyPass /login http://localhost:7201/login
    ProxyPassReverse /login http://localhost:7201/login


    
      ProxyPass /import http://localhost:7201/import
    ProxyPassReverse /import http://localhost:7201/import


    
      ProxyPass /resource http://localhost:7201/resource
    ProxyPassReverse /resource http://localhost:7201/resource


    RewriteEngine on
    RewriteCond %{SERVER_NAME} =kflow.eurecom.fr
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
        ServerName kflow.eurecom.fr
        ServerAdmin troncy@eurecom.fr

        DocumentRoot "/var/www/kflow/"

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        ProxyPass        /api         http://localhost:8873/api
        ProxyPassReverse /api         http://localhost:8873/api

        ProxyPass        /         http://localhost:7201/
        ProxyPassReverse /         http://localhost:7201/

        RewriteEngine on
        RewriteCond %{SERVER_NAME} =kflow.eurecom.fr

</VirtualHost>
